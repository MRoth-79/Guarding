<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×× ×ª×— ×˜×‘×œ×ª ××©××¨×•×ª ×©×‘×•×¢×™×ª</title>
    <style>
        /* ×¡×’× ×•× ×•×ª ×›×œ×œ×™×™× ×•××™× ×˜×¨××§×˜×™×‘×™×•×ª */
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            direction: rtl; 
            background-color: #f7f9f9; 
            color: #333; 
        }
        h2 { 
            color: #00838f; 
            border-bottom: 2px solid #e0f2f1; 
            padding-bottom: 15px; 
            margin-bottom: 30px;
        }
        
        /* ××¢×‘×¨×™× ×—×œ×§×™× ×œ××™× ×˜×¨××§×˜×™×‘×™×•×ª */
        #schedule-table td, .person, button, #dataToAnalyze {
            transition: all 0.2s ease-in-out;
        }

        /* ×¡×§×©×Ÿ ×”×§×œ×˜ ×”×¨××©×™ */
        #input-section-wrapper { 
            display: flex; 
            justify-content: center; 
            margin: 20px auto; 
            width: 90%; 
            max-width: 850px; 
        }
        #data-source-section { 
            padding: 30px; 
            border: 1px solid #b3e5fc; 
            background-color: #ffffff; 
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08); 
            border-radius: 12px; 
            flex: 1; 
            text-align: right; 
        }

        /* ×ª×™×‘×ª ×”×˜×§×¡×˜ */
        #dataToAnalyze {
            width: 100%; 
            min-height: 300px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 0.95em;
            direction: ltr;
            border: 1px solid #81d4fa; 
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
            background-color: #fcfcfc;
            resize: vertical;
        }
        /* ××¤×§×˜ ×¨×™×—×•×£ ×¢×œ ×ª×™×‘×ª ×”×§×œ×˜ */
        #dataToAnalyze:focus {
            border: 1px solid #03a9f4; 
            box-shadow: 0 0 10px rgba(3, 169, 244, 0.3);
        }


        /* ×›×¤×ª×•×¨×™× ×‘×ª×•×š ×¡×§×©×Ÿ ×”×§×œ×˜ */
        #button-group {
            display: flex;
            justify-content: space-between; 
            margin-top: 20px;
            gap: 10px; /* ×¦××¦×•× ×”××¨×•×•×—×™× ×›×“×™ ×œ×”×›×™×œ ×™×•×ª×¨ ×›×¤×ª×•×¨×™× */
        }

        /* ×¡×’× ×•×Ÿ ×›×¤×ª×•×¨ ×‘×¡×™×¡×™ */
        #analyzeButton, #resetButton, #downloadButton, #generateLinkButton {
            padding: 12px 10px; 
            border: none;
            border-radius: 25px; 
            cursor: pointer;
            font-size: 0.9em; /* ×”×§×˜× ×ª ×¤×•× ×˜ ×›×“×™ ×©×™×™×›× ×¡×• ×™×•×ª×¨ ×›×¤×ª×•×¨×™× */
            font-weight: bold;
            flex-grow: 1; 
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            white-space: nowrap; /* ××•× ×¢ ×©×‘×™×¨×ª ×©×•×¨×” */
        }
        
        /* × ×ª×— × ×ª×•× ×™× */
        #analyzeButton { 
            background-color: #4db6ac; 
            color: white; 
        }
        #analyzeButton:hover { 
            background-color: #00897b; 
            transform: translateY(-2px); 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        /* ×”×•×¨×“×ª CSV */
        #downloadButton {
            background-color: #673AB7; 
            color: white;
        }
        #downloadButton:hover { 
            background-color: #512DA8; 
            transform: translateY(-2px); 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); 
        }

        /* ×›×¤×ª×•×¨ ×”×•×¨×“×ª HTML (×¢×“×›×•×Ÿ ×¡×’× ×•×Ÿ ×œ×™×¨×•×§ ×›×”×”) */
        #generateLinkButton {
            background-color: #388e3c; 
            color: white;
        }
        #generateLinkButton:hover { 
            background-color: #2e7d32; 
            transform: translateY(-2px); 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); 
        }

        /* ××™×¤×•×¡ × ×ª×•× ×™× */
        #resetButton {
            background-color: #ffb74d; 
            color: #333;
        }
        #resetButton:hover { 
            background-color: #ffa726; 
            transform: translateY(-2px); 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        /* ×›×¤×ª×•×¨ ×”×¡×™×“×•×¨ ×”××•×˜×•××˜×™ - ×¨×—×‘ ×•×‘×•×œ×˜ */
        #autoScheduleButton {
            padding: 15px 30px; 
            margin: 30px auto 15px auto; 
            background-color: #4fc3f7; 
            color: #ffffff; 
            border: none;
            border-radius: 30px; 
            cursor: pointer;
            font-size: 1.3em; 
            font-weight: bold;
            transition: all 0.3s, box-shadow 0.3s;
            display: block; 
            width: 70%; 
            max-width: 600px;
            box-shadow: 0 6px 20px rgba(79, 195, 247, 0.6); 
        }
        #autoScheduleButton:hover { 
            background-color: #03a9f4; 
            box-shadow: 0 8px 25px rgba(3, 169, 244, 0.7); 
            transform: translateY(-3px); 
        }


        .file-format-info { font-size: 0.9em; color: #546e7a; margin-top: 10px; line-height: 1.5; text-align: right; }
        
        /* ×¢×™×¦×•×‘ ×”×˜×‘×œ×” */
        table { width: 95%; margin: 30px auto; border-collapse: collapse; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1); border: 1px solid #eceff1; border-radius: 12px; overflow: hidden;}
        th, td { border: 1px solid #e0f7fa; padding: 10px 5px; vertical-align: middle; text-align: center; height: 60px; }
        th { background-color: #e0f7fa; font-weight: bold; color: #00838f; }
        
        /* ××¤×§×˜ ×¨×™×—×•×£ ××™× ×˜×¨××§×˜×™×‘×™ ×¢×œ ×ª××™ ×”×˜×‘×œ×” */
        #schedule-table td {
            cursor: default;
        }
        #schedule-table td:hover {
            transform: scale(1.01);
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .time-slot { width: 10%; background-color: #b3e5fc; font-weight: bold; text-align: center; color: #006064; }
        
        /* ×¢×™×¦×•×‘ ×ª×’×™×ª ×”×¢×•×‘×“ */
        .person { 
            display: inline-block; 
            margin: 3px 4px; 
            padding: 5px 10px; 
            border-radius: 20px; 
            white-space: nowrap; 
            font-size: 0.9em; 
            color: #1a1a1a; 
            font-weight: bold; 
            border: 1px solid rgba(0, 0, 0, 0.1); 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
        }
        /* ××¤×§×˜ ×¨×™×—×•×£ ×¢×œ ×ª×’×™×ª ×¢×•×‘×“ */
        .person:hover {
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            transform: translateY(-1px);
        }

        /* ×¡×’× ×•× ×•×ª ××¦×‘ */
        .ok-shift { background-color: #e8f5e9; } 
        .night-shift-ok { background-color: #e3f2fd; } 
        .needs-selection { background-color: #ffebee !important; border: 2px solid #ef9a9a; } 
        .daily-duplicate-warning { background-color: #fffde7 !important; border: 3px dashed #ffb300; } 
        .warning-text { color: #d32f2f; font-weight: bold; font-size: 0.8em; display: block; margin-top: 5px; }
        
        /* ×˜×‘×œ×ª ×”×¡×™×›×•× */
        #summary-table { width: 50%; min-width: 350px; margin: 20px auto; border: 1px solid #cfd8dc; }
        #summary-table th { background-color: #ede7f6; color: #512da8; }
        .met-condition { background-color: #c8e6c9; font-weight: bold; } 
        .not-met-condition { background-color: #ffcdd2; font-weight: bold; } 
        .low-shifts { background-color: #ffcdd2; font-weight: bold; } 

        /* ××¤×•×ª ×¦×‘×¢×™× (×œ×œ× ×©×™× ×•×™) */
        .color-×¡×ª×™×• { background-color: #ffcdd2; } .color-× ×ª×™ { background-color: #fce4ec; } .color-×—×¡×•×Ÿ { background-color: #d1c4e9; } .color-×—×•×¨×—×” { background-color: #bbdefb; }
        .color-×¢×¨×Ÿ { background-color: #b2ebf2; } .color-×œ×™×©×¢ { background-color: #c8e6c9; } .color-×œ×™×× ×™ { background-color: #fff9c4; } .color-× ××¨×•×“ { background-color: #ffccbc; }
        .color-×××•×¨ { background-color: #e6ee9c; } .color-××¡×£ { background-color: #b3e5fc; } .color-×˜×’× ×™×” { background-color: #ffecb3; } .color-×¢×™×“×Ÿ_×™× ×™×‘ { background-color: #d7ccc8; }
        .color-×’×•×œ×Ÿ { background-color: #a7ffeb; } .color-×©×œ×•××™ { background-color: #c5cae9; } .color-×™×•×‘×™ { background-color: #ffd180; } .color-×××™×¨ { background-color: #f8bbd0; }
        .color-×—×‘×¨×•× ×™ { background-color: #b3e5fc; } .color-×—×’×™ { background-color: #ff8a80; } .color-×™×©×™ { background-color: #e0f2f1; } .color-× ×™×¨ { background-color: #dcedc8; }

        /* ×”×•×“×¢×ª ×§×™×©×•×¨ ×©×¦×¤×” - ×—×“×© (× ×©××¨ ×œ××¨×•×ª ×”×©×™× ×•×™, ××‘×œ ×œ× ×‘×©×™××•×©) */
        #link-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #4CAF50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none;
            font-size: 1.1em;
        }

    </style>
</head>
<body onload="initializeData(); document.getElementById('analyzeButton').click();">

    <h2>×× ×ª×— ×˜×‘×œ×ª ××©××¨×•×ª ×©×‘×•×¢×™×ª</h2>
    
    <div id="input-section-wrapper">
        
        <div id="data-source-section">
            <h3>× ×ª×•× ×™ ××©××¨×•×ª ×œ×¢×¨×™×›×” ×•××§×•×¨ ×”× ×ª×•× ×™× âœï¸</h3>
            <p class="file-format-info" style="color: #4caf50; font-weight: bold;">
                ×”× ×ª×•× ×™× ×©×”×•×–× ×• ×›××Ÿ ×™×©××©×• ×œ× ×™×ª×•×—. **×”×¡×™×“×•×¨ ×”××•×˜×•××˜×™ ×™×ª×—×©×‘ ×¨×§ ×‘×¢×•×‘×“×™× ×©×¨×©××ª× ×›××•×¤×¦×™×” ×œ×›×œ ××©×‘×¦×ª!**
            </p>
            <textarea id="dataToAnalyze" 
                title="× ×ª×•× ×™ ××©××¨×•×ª ×œ×¢×¨×™×›×” ×•× ×™×ª×•×—"
                placeholder="×”×“×‘×§ ××ª × ×ª×•× ×™ ×”××©××¨×•×ª ×›××Ÿ (×¤×•×¨××˜: ×™×•×\n×©×¢×•×ª\t×¢×•×‘×“1\t×¢×•×‘×“2...)">
            </textarea>
            
            <div id="button-group">
                <button id="analyzeButton">× ×ª×— × ×ª×•× ×™× ğŸ”</button>
                <button id="downloadButton">×”×•×¨×“ ×§×•×‘×¥ CSV â¬‡ï¸</button>
                <button id="generateLinkButton">×”×•×¨×“ ×˜×‘×œ×ª HTML ××¢×•×¦×‘×ª ğŸ’¾</button> <button id="resetButton">××¤×¡ × ×ª×•× ×™× ğŸ—‘ï¸</button>
            </div>
        </div>
        
    </div>
    
    <button id="autoScheduleButton">×¡×“×¨ ××•×˜×•××˜×™ ğŸ¤–</button>

    <div id="results-container">
        <p id="initial-message">×”×˜×¢×™× ×” ×”×¨××©×•× ×™×ª ×ª×¤×¢×™×œ ××ª ×”× ×™×ª×•×— ××•×˜×•××˜×™×ª.</p>
    </div>

    <div id="link-message">
        <p>âœ… ×§×•×‘×¥ HTML ×”×•×¨×“ ×œ××—×©×‘×š!</p>
    </div>

    <script>
        // × ×ª×•× ×™ ×”×‘×¡×™×¡ ×”××§×•×¨×™×™× ×›××©×ª× ×” ×§×‘×•×¢
        const INITIAL_SCHEDULE_DATA = `×™×•× ×¨××©×•×Ÿ
02:00 - 06:00	×¡×ª×™×•	× ×ª×™	×—×¡×•×Ÿ	×—×•×¨×—×”	×¢×¨×Ÿ	×œ×™×©×¢	×’×•×œ×Ÿ	×©×œ×•××™					
06:00 - 10:00	×œ×™×× ×™	×¢×¨×Ÿ	×××™×¨	×™×•×‘×™									
10:00 - 14:00	×—×’×™	×—×¡×•×Ÿ	×¢×¨×Ÿ	×™×©×™	×’×•×œ×Ÿ	×××™×¨	×—×‘×¨×•× ×™	×—×’×™					
14:00 - 18:00	×œ×™×× ×™	×¢×¨×Ÿ	×××•×¨	×™×•×‘×™	×™×©×™								
18:00 - 22:00	×¢×™×“×Ÿ ×™× ×™×‘	×œ×™×× ×™	××¡×£	×¢×¨×Ÿ	×˜×’× ×™×”	×—×’×™	×™×©×™						
22:00 - 02:00	×¡×ª×™×•	× ×ª×™	××¡×£	×—×•×¨×—×”	× ××¨×•×“	×—×¡×•×Ÿ	×¢×¨×Ÿ	×œ×™×©×¢	×××•×¨				
													
×™×•× ×©× ×™													
02:00 - 06:00	×¡×ª×™×•	× ×ª×™	×—×¡×•×Ÿ	×¢×¨×Ÿ	×œ×™×©×¢	×™×©×™							
06:00 - 10:00	× ××¨×•×“	×××•×¨	×××™×¨	×—×’×™									
10:00 - 14:00	×—×¡×•×Ÿ	× ×™×¨	×—×‘×¨×•× ×™	×™×•×‘×™	×’×•×œ×Ÿ	×™×©×™	×©×œ×•××™						
14:00 - 18:00	×××•×¨	× ×™×¨	×™×•×‘×™	×××™×¨	×—×’×™								
18:00 - 22:00	×œ×™×× ×™	××¡×£	×˜×’× ×™×”	×—×•×¨×—×”	×™×©×™	×××™×¨							
22:00 - 02:00	×¢×™×“×Ÿ ×™× ×™×‘	× ×ª×™	××¡×£	×—×•×¨×—×”	×œ×™×©×¢	×—×‘×¨×•× ×™	×—×’×™						
													
×™×•× ×©×œ×™×©×™													
02:00 - 06:00	× ×ª×™	××¡×£	×¢×¨×Ÿ	×˜×’× ×™×”	×—×’×™	×™×©×™							
06:00 - 10:00	××¡×£	× ××¨×•×“	×¢×¨×Ÿ	×™×•×‘×™	×’×•×œ×Ÿ								
10:00 - 14:00	×œ×™×× ×™	××¡×£	×—×¡×•×Ÿ	×¢×¨×Ÿ	×—×’×™	×™×©×™							
14:00 - 18:00	××¡×£	× ×™×¨	×××™×¨	×™×•×‘×™									
18:00 - 22:00	×œ×™×× ×™	×—×¡×•×Ÿ	× ××¨×•×“	×¢×¨×Ÿ	×˜×’× ×™×”	×—×‘×¨×•× ×™	×™×©×™	×©×œ×•××™					
22:00 - 02:00	×¢×™×“×Ÿ ×™× ×™×‘	×¡×ª×™×•	× ×ª×™	×—×¡×•×Ÿ	× ××¨×•×“	×¢×¨×Ÿ	×’×•×œ×Ÿ	×—×‘×¨×•× ×™					
													
×™×•× ×¨×‘×™×¢×™													
02:00 - 06:00	×¢×™×“×Ÿ ×™× ×™×‘	×¡×ª×™×•	× ×ª×™	× ××¨×•×“	×—×¡×•×Ÿ	×¢×¨×Ÿ							
06:00 - 10:00	×œ×™×× ×™	× ××¨×•×“	×¢×¨×Ÿ	×××•×¨	×××™×¨	×’×•×œ×Ÿ	×—×’×™						
10:00 - 14:00	×œ×™×× ×™	×—×¡×•×Ÿ	×¢×¨×Ÿ	×—×‘×¨×•× ×™	×™×©×™	×—×’×™							
14:00 - 18:00	×œ×™×× ×™	×—×¡×•×Ÿ	× ×™×¨	×××™×¨	×’×•×œ×Ÿ								
18:00 - 22:00	×¢×™×“×Ÿ ×™× ×™×‘	×œ×™×× ×™	××¡×£	×¢×¨×Ÿ	×œ×™×©×¢	×˜×’× ×™×”	×××•×¨						
22:00 - 02:00	×¡×ª×™×•	× ×ª×™	××¡×£	×—×•×¨×—×”	× ××¨×•×“	×¢×¨×Ÿ	×œ×™×©×¢	×××•×¨					
													
×™×•× ×—××™×©×™													
02:00 - 06:00	×¡×ª×™×•	× ×ª×™	×—×¡×•×Ÿ	×¢×¨×Ÿ	×œ×™×©×¢	×™×•×‘×™	×—×’×™	×©×œ×•××™					
06:00 - 10:00	×œ×™×× ×™	×¢×¨×Ÿ	×××•×¨	×—×•×¨×—×”	×™×•×‘×™	×××™×¨	×’×•×œ×Ÿ						
10:00 - 14:00	×œ×™×× ×™	×¢×¨×Ÿ	× ×™×¨	×™×©×™									
14:00 - 18:00	×œ×™×× ×™	×—×¡×•×Ÿ	× ×™×¨	×—×•×¨×—×”	×™×•×‘×™	×’×•×œ×Ÿ							
18:00 - 22:00	×œ×™×× ×™	××¡×£	×—×‘×¨×•× ×™	×—×•×¨×—×”	×œ×™×©×¢	×××•×¨	×™×©×™	×—×’×™					
22:00 - 02:00	×¢×™×“×Ÿ ×™× ×™×‘	×¡×ª×™×•	× ×ª×™	× ××¨×•×“	××¡×£	×¢×¨×Ÿ	×œ×™×©×¢	×˜×’× ×™×”	×××•×¨				
													
×™×•× ×©×™×©×™													
02:00 - 06:00	×¢×™×“×Ÿ ×™× ×™×‘	×¡×ª×™×•	× ×ª×™	× ××¨×•×“	××¡×£	×¢×¨×Ÿ	×˜×’× ×™×”						
06:00 - 10:00	×¢×™×“×Ÿ ×™× ×™×‘	××¡×£	×××•×¨	×—×•×¨×—×”	×××™×¨	×’×•×œ×Ÿ							
10:00 - 14:00	××¡×£	×™×©×™	×—×’×™										
14:00 - 18:00	××¡×£	×—×’×™	× ×™×¨	×—×•×¨×—×”	×™×•×‘×™	×××™×¨	×’×•×œ×Ÿ						
18:00 - 22:00	× ××¨×•×“	×˜×’× ×™×”											
22:00 - 02:00	×¢×™×“×Ÿ ×™× ×™×‘	×¡×ª×™×•	× ×ª×™	×œ×™×× ×™	× ××¨×•×“	××¡×£	×˜×’× ×™×”						
													
×™×•× ×©×‘×ª													
02:00 - 06:00	×¢×™×“×Ÿ ×™× ×™×‘	× ×ª×™	××¡×£	×—×•×¨×—×”	×˜×’× ×™×”	×©×œ×•××™	×—×‘×¨×•× ×™						
06:00 - 10:00	×¢×™×“×Ÿ ×™× ×™×‘	××¡×£	× ××¨×•×“	×—×•×¨×—×”	×—×’×™	×××™×¨		×—×’×™					
10:00 - 14:00	×’×•×œ×Ÿ	×©×œ×•××™	×™×©×™	×™×•×‘×™	×—×‘×¨×•× ×™								
14:00 - 18:00	×’×•×œ×Ÿ	×××™×¨	×—×‘×¨×•× ×™	×™×•×‘×™									
18:00 - 22:00	×œ×™×©×¢	× ××¨×•×“	× ×™×¨	×—×‘×¨×•× ×™	×™×©×™								
22:00 - 02:00	×œ×™×× ×™	× ×ª×™	××¡×£	× ××¨×•×“	×œ×™×©×¢	×××•×¨	×—×‘×¨×•× ×™`;

        // ××©×ª× ×” ×’×œ×•×‘×œ×™ ×œ×©××™×¨×ª ×§×•×“ ×”-HTML ×©×œ ×”×˜×‘×œ×” ×”××¢×•×¦×‘×ª
        let lastRenderedTableHTML = '';


        // ×”×’×“×¨×•×ª ×§×‘×•×¢×•×ª
        const MIN_REQUIRED = 3;
        const MAX_ALLOWED = 4;
        const EXPECTED_DAYS = ['×™×•× ×¨××©×•×Ÿ', '×™×•× ×©× ×™', '×™×•× ×©×œ×™×©×™', '×™×•× ×¨×‘×™×¢×™', '×™×•× ×—××™×©×™', '×™×•× ×©×™×©×™', '×™×•× ×©×‘×ª'];
        const EXPECTED_TIME_SLOTS = [
            '02:00 - 06:00 (Night)', '06:00 - 10:00', '10:00 - 14:00', 
            '14:00 - 18:00', '18:00 - 22:00', '22:00 - 02:00 (Night)'
        ];

        // ××¤×ª ×¦×‘×¢×™× (×¨×©×™××ª ×”×¢×•×‘×“×™× ×”×–××™× ×™× ×œ×¡×™×“×•×¨)
        const colorMap = {
            '×¡×ª×™×•': 'color-×¡×ª×™×•', '× ×ª×™': 'color-× ×ª×™', '×—×¡×•×Ÿ': 'color-×—×¡×•×Ÿ', '×—×•×¨×—×”': 'color-×—×•×¨×—×”',
            '×¢×¨×Ÿ': 'color-×¢×¨×Ÿ', '×œ×™×©×¢': 'color-×œ×™×©×¢', '×œ×™×× ×™': 'color-×œ×™×× ×™', '× ××¨×•×“': 'color-× ××¨×•×“',
            '×××•×¨': 'color-×××•×¨', '××¡×£': 'color-××¡×£', '×˜×’× ×™×”': 'color-×˜×’× ×™×”', '×¢×™×“×Ÿ ×™× ×™×‘': 'color-×¢×™×“×Ÿ_×™× ×™×‘',
            '×’×•×œ×Ÿ': 'color-×’×•×œ×Ÿ', '×©×œ×•××™': 'color-×©×œ×•××™', '×™×•×‘×™': 'color-×™×•×‘×™', '×××™×¨': 'color-×××™×¨',
            '×—×‘×¨×•× ×™': 'color-×—×‘×¨×•× ×™', '×—×’×™': 'color-×—×’×™', '×™×©×™': 'color-×™×©×™', '× ×™×¨': 'color-× ×™×¨'
        };

        /**
         * ×¤×•× ×§×¦×™×” ×œ××ª×—×•×œ ×”× ×ª×•× ×™×
         */
        function initializeData() {
            document.getElementById('dataToAnalyze').value = INITIAL_SCHEDULE_DATA; 
        }

        /**
         * ×¤×•× ×§×¦×™×” ×œ× ×™×§×•×™ ××’×¨×¡×™×‘×™ ×©×œ ×©×•×¨×” ××ª×•×•×™× ×‘×œ×ª×™ × ×¨××™× ×•×¨×™×•×•×—
         */
        function aggressiveClean(line) {
            return line.replace(/[\u0000-\u001F\u007F-\u009F\uFEFF\u00A0]/g, '').trim();
        }
        
        /**
         * ×¤×•× ×§×¦×™×” ×œ×¢×™×‘×•×“ ×˜×§×¡×˜ ×¢× ×—×œ×•×§×” ×× ×›×™×ª ×œ×¤×™ ×™××™×
         * (××©××©×ª ×’× ×œ××™×¡×•×£ ×”××™×œ×•×¦×™× ×›×˜×‘×œ×ª × ×ª×•× ×™×)
         */
        function parseVerticalText(text) {
            const lines = text.split(/\r?\n|\r/); 
            const rawDayData = {};
            let currentDay = null;

            lines.forEach(line => {
                const cleanedLine = aggressiveClean(line);
                
                if (cleanedLine.length === 0) {
                    return;
                }

                const dayMatch = EXPECTED_DAYS.find(day => cleanedLine === day || cleanedLine.startsWith(day));

                if (dayMatch) {
                    currentDay = dayMatch;
                    rawDayData[currentDay] = [];
                } else if (currentDay) {
                    const parts = line.split(/\s{2,}|\t/).map(p => p.trim()); 
                    const timeSlotString = parts[0];
                    const isTimeSlot = EXPECTED_TIME_SLOTS.some(slot => timeSlotString && slot.includes(timeSlotString.split(' ')[0])); 

                    if (parts.length > 0 && isTimeSlot) {
                        const potentialNames = parts.slice(1);
                        const names = potentialNames.filter(name => name.length > 0).map(name => name.trim());
                        // ×©×•××¨ ××ª ×”×©××•×ª ××•×¤×¨×“×™× ×‘×¤×¡×™×§×™× (×›×“×™ ×©×™×”×™×” ×§×œ ×™×•×ª×¨ ×œ×—×–×•×¨ ×œ×˜×§×¡×˜)
                        rawDayData[currentDay].push(names.join(','));
                    }
                }
            });

            const daysFound = Object.keys(rawDayData);
            
            if (daysFound.length === 0) {
                return { error: '×œ× × ××¦××• × ×ª×•× ×™× ×ª×§×™× ×™× ××• ×©×œ× ×–×•×”×• ×™××™× ×‘×¤×•×¨××˜ × ×›×•×Ÿ. ×•×“× ×©×”× ×ª×•× ×™× ××ª×—×™×œ×™× ×‘"×™×•× ×¨××©×•×Ÿ".' };
            }

            // ... (×‘×“×™×§×ª ×›××•×ª ×”×™××™× ×•×›××•×ª ×”××©××¨×•×ª × ×©××¨×ª ×–×”×”) ...

            const scheduleTable = []; 
            for (let i = 0; i < EXPECTED_TIME_SLOTS.length; i++) {
                const row = [];
                for (let j = 0; j < EXPECTED_DAYS.length; j++) {
                    const day = EXPECTED_DAYS[j];
                    const dayShifts = rawDayData[day];
                    
                    if (!dayShifts || dayShifts.length !== EXPECTED_TIME_SLOTS.length) {
                        return { error: `×©×’×™××” ×‘×™×•× **${day}**: × ××¦××• ×¨×§ ${dayShifts?.length || 0} ××©××¨×•×ª ×‘××§×•× ${EXPECTED_TIME_SLOTS.length} ××©××¨×•×ª. ×™×© ×œ×ª×§×Ÿ ××ª ×›××•×ª ×”×©×•×¨×•×ª ×‘×™×•× ×–×”.` };
                    }
                    row.push(dayShifts[i]);
                }
                scheduleTable.push(row);
            }

            return { days: EXPECTED_DAYS, data: scheduleTable };
        }

        /**
         * ×¤×•× ×§×¦×™×” ×œ×‘× ×™×™×ª ×”×˜×‘×œ×” ×•×‘×™×¦×•×¢ ×”× ×™×ª×•×—
         */
        function renderSchedule(parsedData) {
            const resultsContainer = document.getElementById('results-container');
            
            if (parsedData.error) {
                resultsContainer.innerHTML = `<p class="warning-text">âŒ ×©×’×™××ª × ×ª×•× ×™×: ${parsedData.error}</p>`;
                return;
            }

            const { days: dayHeaders, data: scheduleData } = parsedData;

            // **1. ×™×¦×™×¨×ª HTML ×¢×‘×•×¨ ×”×˜×‘×œ×” ×”×× ×•×ª×—×ª**
            let tableHTML = '<h3>×˜×‘×œ×ª ××©××¨×•×ª ×× ×•×ª×—×ª</h3>';
            
            tableHTML += '<p class="file-format-info" style="text-align: center; color: #4db6ac;">**×”×’×“×¨×•×ª:** ××©××¨×ª ×™×•× (06:00-22:00): 1 ×¢×•×‘×“. ××©××¨×ª ×œ×™×œ×” (02:00-06:00, 22:00-02:00): ×¢×“ 2 ×¢×•×‘×“×™×.</p>';

            // ×™×¦×™×¨×ª ×˜×‘×œ×ª ×”× ×ª×•× ×™× ×”×¨××©×™×ª
            let scheduleTableHTML = '<table id="schedule-table"><thead><tr><th>×©×¢×•×ª / ×™×•×</th>';
            dayHeaders.forEach(day => { scheduleTableHTML += `<th>${day}</th>`; });
            scheduleTableHTML += '</tr></thead><tbody>';

            const allShifts = {};
            const dailyCheck = {};
            
            scheduleData.forEach((row, rowIndex) => {
                const timeSlotFull = EXPECTED_TIME_SLOTS[rowIndex];
                const isNightShift = timeSlotFull.includes('(Night)');
                const timeSlotDisplay = timeSlotFull.replace(' (Night)', '');
                const maxAllowedInShift = isNightShift ? 2 : 1;
                
                scheduleTableHTML += `<tr><td class="time-slot">${timeSlotDisplay}</td>`;

                row.forEach((cellContent, colIndex) => {
                    const day = dayHeaders[colIndex];
                    const names = cellContent.split(',').filter(name => name);
                    const numNames = names.length;
                    
                    if (!dailyCheck[day]) { dailyCheck[day] = new Set(); }
                    
                    let dailyDuplicateFound = false;
                    names.forEach(name => {
                        const cleanedName = name.trim();
                        // 1. ×‘×“×™×§×ª ×›×¤×™×œ×•×ª ×™×•××™×ª
                        if (dailyCheck[day].has(cleanedName)) {
                            dailyDuplicateFound = true;
                        }
                        dailyCheck[day].add(cleanedName);
                        
                        // 2. ××™×¡×•×£ ×›×œ×œ×™ ×œ×ª×“×™×¨×•×ª ×©×‘×•×¢×™×ª
                        allShifts[cleanedName] = (allShifts[cleanedName] || 0) + 1;
                    });
                    
                    // ×¢×™×¦×•×‘ ×”×ª×
                    let cellClass = '';
                    let warningText = '';

                    if (numNames === 0) {
                        cellClass = 'needs-selection';
                        warningText = '<span class="warning-text">×‘×¢×™×”! ××©×‘×¦×ª ×¨×™×§×”</span>';
                    } else if (dailyDuplicateFound) {
                        cellClass = 'daily-duplicate-warning';
                        warningText = '<span class="warning-text">âš ï¸ ×›×¤×™×œ×•×ª ×™×•××™×ª!</span>';
                    } else if (numNames > maxAllowedInShift && numNames > 0) {
                         // ×× ×™×© ×™×•×ª×¨ ×¢×•×‘×“×™× ×××” ×©× ×“×¨×©, ×× ×—× ×• ××¦×™×’×™× ××–×”×¨×”
                        cellClass = 'needs-selection'; 
                        warningText = `<span class="warning-text">âš ï¸ ×™×•×ª×¨ ××“×™ ×¢×•×‘×“×™× (${numNames}). ×“×¨×•×©×™×: ${maxAllowedInShift}</span>`;
                    } else {
                        cellClass = isNightShift ? 'night-shift-ok' : 'ok-shift';
                    }

                    const formattedNames = names.map(name => {
                        const key = name.includes(' ') ? name.trim().replace(' ', '_') : name.trim();
                        const className = colorMap[key] || 'person';
                        return `<span class="person ${className}">${name}</span>`;
                    }).join('');

                    scheduleTableHTML += `<td data-day="${day}" data-time="${timeSlotDisplay}" class="${cellClass}">
                        ${formattedNames} ${warningText}
                    </td>`;
                });
                scheduleTableHTML += '</tr>';
            });
            scheduleTableHTML += '</tbody></table>';
            
            // **2. ×©××™×¨×ª ×”-HTML ×©×œ ×”×˜×‘×œ×” ×œ××©×ª× ×” ×’×œ×•×‘×œ×™**
            lastRenderedTableHTML = scheduleTableHTML; 
            
            // **3. ×”××©×š ×™×¦×™×¨×ª ×˜×‘×œ×ª ×”×¡×™×›×•× ×•×”×¦×’×”**
            tableHTML += scheduleTableHTML + '<hr>';

            // ×™×¦×™×¨×ª ×˜×‘×œ×ª ×”×¡×™×›×•×
            let summaryTableHTML = '<h3>×¡×™×›×•× ×ª×“×™×¨×•×ª ×”×•×¤×¢×” ×©×œ ×›×œ ×¢×•×‘×“ (××™× ×™××•×: 3, ××§×¡×™××•×: 4)</h3>';
            summaryTableHTML += `
                <table id="summary-table">
                    <thead>
                        <tr>
                            <th>××¡'</th>
                            <th>×©× ×”×¢×•×‘×“</th>
                            <th>×¡×š ×”×•×¤×¢×•×ª</th>
                            <th>×¢××™×“×” ×‘×ª× ××™ (3-4)</th>
                        </tr>
                    </thead>
                    <tbody id="summary-body">`;
            
            const sortedNames = Object.keys(allShifts).sort();
            let counter = 1;
            sortedNames.forEach(name => {
                const count = allShifts[name];
                
                let rowClass = 'met-condition';
                let statusText = 'âœ… ×¢××“';
                
                if (count < MIN_REQUIRED) {
                    rowClass = 'low-shifts';
                    statusText = `âŒ ×œ× ×¢××“ (××¢×˜ ××“×™ - ${count})`;
                } else if (count > MAX_ALLOWED) {
                    rowClass = 'not-met-condition';
                    statusText = `âŒ ×œ× ×¢××“ (×™×•×ª×¨ ××“×™ - ${count})`;
                }
                
                summaryTableHTML += `
                    <tr class="${rowClass}">
                        <td style="text-align: center;">${counter++}</td>
                        <td>${name}</td>
                        <td style="text-align: center;">${count}</td>
                        <td style="text-align: center;">${statusText}</td>
                    </tr>
                `;
            });

            summaryTableHTML += '</tbody></table>';
            
            tableHTML += summaryTableHTML;

            resultsContainer.innerHTML = tableHTML;
        }


        /**
         * ×¤×•× ×§×¦×™×” ××¢×•×“×›× ×ª ×œ×”×•×¨×“×ª ×§×•×‘×¥ HTML ×©××›×™×œ ×¨×§ ××ª ×”×˜×‘×œ×” ×”××¢×•×¦×‘×ª
         */
        function downloadHtmlTable() {
            if (!lastRenderedTableHTML) {
                alert('××™×Ÿ ×˜×‘×œ×ª ××©××¨×•×ª ×× ×•×ª×—×ª! ×× × ×”×¤×¢×œ ××ª "×¡×“×¨ ××•×˜×•××˜×™ ğŸ¤–" ××• "× ×ª×— × ×ª×•× ×™× ğŸ”" ×ª×—×™×œ×”.');
                return;
            }

            // ××•×¡×¤×™× ××ª ×›×œ ×”-CSS ×”×§×¨×™×˜×™ ××”×ª×’×™×ª <style>
            const style = document.querySelector('style').textContent;

            // ×™×•×¦×¨×™× ××ª ×§×•×‘×¥ ×”-HTML ×”× ×§×™ (××‘×•×“×“)
            const cleanHTMLContent = `
                <!DOCTYPE html>
                <html lang="he" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>×˜×‘×œ×ª ××©××¨×•×ª ×©×‘×•×¢×™×ª - ××¢×•×¦×‘×ª</title>
                    <style>
                        /* ×¡×’× ×•× ×•×ª ×‘×¡×™×¡×™×™× */
                        body { font-family: Arial, sans-serif; text-align: center; direction: rtl; background-color: #f7f9f9; color: #333; }
                        h2 { color: #00838f; padding-bottom: 15px; margin-bottom: 30px; }
                        
                        /* ××“×‘×™×§×™× ×›××Ÿ ××ª ×”-CSS ×”×¨×œ×•×•× ×˜×™ - ×¨×§ ×©×œ ×”×˜×‘×œ××•×ª */
                        ${style}
                        
                        /* ×”×¡×ª×¨×ª ×›×¤×ª×•×¨×™× ×•×¤×•× ×§×¦×™×•× ×œ×™×•×ª ×œ× ×¨×œ×•×•× ×˜×™×™× ×‘×“×£ ×”××•×¤×¨×“ */
                        #input-section-wrapper, #button-group, #autoScheduleButton, #resetButton { display: none !important; }
                        
                    </style>
                </head>
                <body>
                    <h2>×˜×‘×œ×ª ××©××¨×•×ª ×©×‘×•×¢×™×ª - ××©×•×‘×¦×ª ×•×¡×•×¤×™×ª (××¢×•×¦×‘×ª)</h2>
                    
                    <div id="results-container" style="max-width: 90%; margin: 20px auto;">
                        ${lastRenderedTableHTML}
                    </div>
                    <p style="text-align: center; color: #777; margin-top: 30px;">
                        ×“×£ ×–×” × ×•×¦×¨ ××•×˜×•××˜×™×ª ×¢×œ ×™×“×™ ×× ×ª×— ×”××©××¨×•×ª.
                    </p>
                </body>
                </html>
            `;
            
            // ×™×¦×™×¨×ª Blob (×™×™×¦×•×’ ×§×•×‘×¥)
            // ×©×™××•×© ×‘-BOM ×¢×‘×•×¨ ×ª××™××•×ª ×¢×‘×¨×™×ª ×˜×•×‘×” ×™×•×ª×¨
            const bom = '\ufeff'; 
            const blob = new Blob([bom + cleanHTMLContent], { type: 'text/html;charset=utf-8' });
            
            // ×™×¦×™×¨×ª ×œ×™× ×§ ×–×× ×™ ×œ×”×•×¨×“×”
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');

            link.href = url;
            link.download = 'schedule_table_maor.html';
            link.click(); 

            // × ×™×§×•×™ ×”××©××‘×™× ×”×–×× ×™×™×
            URL.revokeObjectURL(url);
            
            // ×”×¦×’×ª ×”×•×“×¢×” ×§×¦×¨×” (×‘××§×•× ×”×”×•×“×¢×” ×”×¦×¤×” ×”×œ× ×¨×œ×•×•× ×˜×™×ª)
             const msg = document.getElementById('link-message');
            msg.querySelector('p').textContent = 'âœ… ×§×•×‘×¥ HTML ×”×•×¨×“ ×œ××—×©×‘×š!';
            msg.style.display = 'block';
            setTimeout(() => {
                msg.style.display = 'none';
            }, 3000);
        }

        // ... (×©××¨ ×”×¤×•× ×§×¦×™×•×ª: autoSchedule, exportToCsv, resetData × ×©××¨×•×ª ×›×¤×™ ×©×”×Ÿ) ...

        // ×¤×•× ×§×¦×™×” ×—×“×©×” ×œ×¡×™×“×•×¨ ××•×˜×•××˜×™ ×©×œ ×”××©××¨×•×ª - ×¢× ××™×œ×•×¦×™×
        function autoSchedule() {
            const textContent = document.getElementById('dataToAnalyze').value;
            const initialParsedData = parseVerticalText(textContent);

            if (initialParsedData.error) {
                document.getElementById('results-container').innerHTML = `<p class="warning-text">âŒ ×©×’×™××” ×‘× ×™×ª×•×— × ×ª×•× ×™× ×§×™×™××™×. ×™×© ×œ×ª×§×Ÿ ××ª × ×ª×•× ×™ ×”×§×œ×˜ ×œ×¤× ×™ ×”×¡×™×“×•×¨ ×”××•×˜×•××˜×™.</p>`;
                return;
            }

            const availabilityMap = {};
            initialParsedData.data.forEach((row, shiftIndex) => {
                row.forEach((cellContent, dayIndex) => {
                    const day = initialParsedData.days[dayIndex];
                    const names = cellContent.split(',').map(name => name.trim()).filter(name => name.length > 0);
                    if (!availabilityMap[day]) {
                        availabilityMap[day] = {};
                    }
                    availabilityMap[day][shiftIndex] = new Set(names);
                });
            });

            const employees = Object.keys(colorMap).map(key => key.includes('_') ? key.replace('_', ' ') : key);
            const schedule = []; 
            const employeeShifts = {}; 
            employees.forEach(name => employeeShifts[name] = 0);
            
            for (let i = 0; i < EXPECTED_DAYS.length; i++) {
                schedule[i] = [];
                for (let j = 0; j < EXPECTED_TIME_SLOTS.length; j++) {
                    schedule[i][j] = []; 
                }
            }

            for (let dayIndex = 0; dayIndex < EXPECTED_DAYS.length; dayIndex++) {
                const day = EXPECTED_DAYS[dayIndex];
                const dayAssignments = new Set(); 
                
                for (let shiftIndex = 0; shiftIndex < EXPECTED_TIME_SLOTS.length; shiftIndex++) {
                    const timeSlotFull = EXPECTED_TIME_SLOTS[shiftIndex];
                    const isNightShift = timeSlotFull.includes('(Night)');
                    const maxRequired = isNightShift ? 2 : 1;
                    
                    const registeredForSlot = availabilityMap[day] && availabilityMap[day][shiftIndex] ? Array.from(availabilityMap[day][shiftIndex]) : [];

                    if (registeredForSlot.length === 0) {
                         schedule[dayIndex][shiftIndex] = []; 
                         continue;
                    }

                    let eligibleCandidates = employees.filter(name => {
                        if (!registeredForSlot.includes(name)) { return false; } 
                        if (dayAssignments.has(name)) { return false; }
                        if (employeeShifts[name] >= MAX_ALLOWED) { return false; }
                        return true;
                    });
                    
                    eligibleCandidates.sort((a, b) => {
                        return employeeShifts[a] - employeeShifts[b];
                    });
                    
                    const assignedPeople = [];
                    
                    for (let i = 0; i < maxRequired; i++) {
                        if (eligibleCandidates.length === 0) break;

                        const selectedEmployee = eligibleCandidates.shift(); 
                        assignedPeople.push(selectedEmployee);
                        
                        employeeShifts[selectedEmployee]++;
                        dayAssignments.add(selectedEmployee);
                    }
                    
                    schedule[dayIndex][shiftIndex] = assignedPeople;
                }
            }
            
            let newScheduleText = '';
            
            for (let dayIndex = 0; dayIndex < EXPECTED_DAYS.length; dayIndex++) {
                const dayName = EXPECTED_DAYS[dayIndex];
                newScheduleText += dayName + '\n';
                
                for (let shiftIndex = 0; shiftIndex < EXPECTED_TIME_SLOTS.length; shiftIndex++) {
                    const timeSlotDisplay = EXPECTED_TIME_SLOTS[shiftIndex].split(' ')[0] + ' - ' + EXPECTED_TIME_SLOTS[shiftIndex].split(' ')[2]; 
                    const assignedNames = schedule[dayIndex][shiftIndex];
                    
                    newScheduleText += timeSlotDisplay + '\t' + assignedNames.join('\t') + '\n';
                }
                newScheduleText += '\n';
            }
            
            document.getElementById('dataToAnalyze').value = newScheduleText.trim();
            document.getElementById('analyzeButton').click();
        }

        /**
         * ×¤×•× ×§×¦×™×” ×œ×™×™×¦×•× × ×ª×•× ×™× ×›×§×•×‘×¥ CSV - ×›×•×œ×œ ×ª×™×§×•×Ÿ ×œ×§×™×“×•×“ ×¢×‘×¨×™×ª
         */
        function exportToCsv() {
            const textContent = document.getElementById('dataToAnalyze').value;
            
            if (!textContent.trim()) {
                alert('××™×Ÿ × ×ª×•× ×™× ×œ×™×™×¦×•×! ×× × ×”×¤×¢×œ ××ª "×¡×“×¨ ××•×˜×•××˜×™ ğŸ¤–" ××• ×”×–×Ÿ × ×ª×•× ×™× ×™×“× ×™×ª.');
                return;
            }

            let csvContent = textContent.replace(/\t/g, ','); 
            
            const bom = '\ufeff'; 
            csvContent = bom + csvContent;

            const filename = 'schedule_shifts_by_auto_scheduler.csv';
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                link.setAttribute("download", filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('×”×“×¤×“×¤×Ÿ ×©×œ×š ××™× ×• ×ª×•××š ×‘×”×•×¨×“×” ××•×˜×•××˜×™×ª. ×× × ×”×¢×ª×§ ××ª ×”×˜×§×¡×˜ ×‘××•×¤×Ÿ ×™×“× ×™.');
            }
        }

        /**
         * ×¤×•× ×§×¦×™×” ×œ××™×¤×•×¡ × ×ª×•× ×™×
         */
        function resetData() {
            document.getElementById('dataToAnalyze').value = '';
            document.getElementById('results-container').innerHTML = '<p id="initial-message" style="color: #03a9f4; font-weight: bold;">×”× ×ª×•× ×™× ××•×¤×¡×•. ×× × ×”×“×‘×§ × ×ª×•× ×™× ×—×“×©×™× ××• ×”×©×ª××© ×‘×›×¤×ª×•×¨ ×”×¡×™×“×•×¨ ×”××•×˜×•××˜×™ (×œ××—×¨ ×”×–× ×ª ××™×œ×•×¦×™×).</p>';
            lastRenderedTableHTML = ''; // ××™×¤×•×¡ ×”-HTML ×”×©××•×¨
        }


        // ××™×¨×•×¢ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ ×”× ×™×ª×•×—
        document.getElementById('analyzeButton').addEventListener('click', () => {
            const textContent = document.getElementById('dataToAnalyze').value; 
            
            if (!textContent.trim()) {
                 document.getElementById('results-container').innerHTML = '<p class="warning-text">âŒ ×× × ×”×“×‘×§ ××ª × ×ª×•× ×™ ×”××©××¨×•×ª ×‘×ª×™×‘×ª ×”×¢×¨×™×›×”.</p>';
                return;
            }
            
            const parsedData = parseVerticalText(textContent);
            
            if (parsedData && !parsedData.error) {
                renderSchedule(parsedData);
            } else {
                const errorMessage = parsedData?.error || '×”× ×ª×•× ×™× ×©×”×•×“×‘×§×• ××™× × ×‘×¤×•×¨××˜ ×ª×§×™×Ÿ ××• ×©×”×ª×¨×—×©×” ×©×’×™××” ×¤× ×™××™×ª ×‘×œ×ª×™ ×¦×¤×•×™×”.';
                document.getElementById('results-container').innerHTML = `<p class="warning-text">âŒ ×©×’×™××” ×‘× ×™×ª×•×— ×”× ×ª×•× ×™×: ${errorMessage}</p>`;
            }
        });

        // ××™×¨×•×¢ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ ×”×¡×™×“×•×¨ ×”××•×˜×•××˜×™
        document.getElementById('autoScheduleButton').addEventListener('click', autoSchedule);
        
        // ××™×¨×•×¢ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ ×”×”×•×¨×“×”
        document.getElementById('downloadButton').addEventListener('click', exportToCsv);
        
        // ××™×¨×•×¢ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ ×”××™×¤×•×¡
        document.getElementById('resetButton').addEventListener('click', resetData);

        // ××™×¨×•×¢ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ ×”×•×¨×“×ª ×”-HTML (×”×¤×•× ×§×¦×™×” ×”××¢×•×“×›× ×ª)
        document.getElementById('generateLinkButton').addEventListener('click', downloadHtmlTable);


    </script>

</body>
</html>
